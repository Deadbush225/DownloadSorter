# Generated at configure time - Qt deployment script
# This script runs during the install phase to deploy Qt runtime dependencies

message(STATUS "=== Qt Deploy Runtime Script Executing ===")
message(STATUS "CMAKE_INSTALL_PREFIX: ${CMAKE_INSTALL_PREFIX}")

# Set Qt installation directory from configure time
set(Qt6_DIR "@Qt6_DIR@")
message(STATUS "Qt6_DIR: ${Qt6_DIR}")

# Include Qt deployment support
if(EXISTS "${Qt6_DIR}/Qt6DeploySupport.cmake")
    include("${Qt6_DIR}/Qt6DeploySupport.cmake")
    message(STATUS "âœ“ Included Qt6DeploySupport.cmake")
else()
    message(FATAL_ERROR "Qt6DeploySupport.cmake not found at: ${Qt6_DIR}/Qt6DeploySupport.cmake")
endif()

# Verify that the deployment command is available
if(NOT COMMAND qt_deploy_runtime_dependencies)
    message(FATAL_ERROR "qt_deploy_runtime_dependencies command not available after including Qt6DeploySupport.cmake")
endif()

# Deployment configuration
set(QT_DEPLOY_BIN_DIR ".")
set(QT_DEPLOY_LIB_DIR ".")
set(QT_DEPLOY_PLUGINS_DIR ".")

# Exclusions and plugin selection  
set(QT_DEPLOY_EXCLUDE_MODULES "Network;NetworkInformation;NetworkAuth;OpenGL;OpenGLWidgets")
set(QT_DEPLOY_EXCLUDE_PLUGINS "tls;*;networkinformation;*;bearer;*;imageformats;qgif;qjpeg;qsvg;generic;qtuiotouchplugin;")
set(QT_DEPLOY_EXCLUDE_LIBRARIES "@QT_DEPLOY_EXCLUDE_LIBS_LIST@")
set(QT_DEPLOY_PLUGINS "@QT_DEPLOY_PLUGINS_LIST@")

# Compute installed executable paths
if(WIN32)
    set(_MAIN_EXE    "${CMAKE_INSTALL_PREFIX}/@MAIN_BASENAME@.exe")
    set(_UPDATER_EXE "${CMAKE_INSTALL_PREFIX}/@UPDATER_BASENAME@.exe")
elseif(APPLE)
    set(_MAIN_EXE    "${CMAKE_INSTALL_PREFIX}/@MAIN_BASENAME@.app")
    set(_UPDATER_EXE "${CMAKE_INSTALL_PREFIX}/@UPDATER_BASENAME@.app")
else()
    set(_MAIN_EXE    "${CMAKE_INSTALL_PREFIX}/@MAIN_BASENAME@")
    set(_UPDATER_EXE "${CMAKE_INSTALL_PREFIX}/@UPDATER_BASENAME@")
endif()

message(STATUS "Main executable: ${_MAIN_EXE}")
message(STATUS "Updater executable: ${_UPDATER_EXE}")
message(STATUS "Deploying Qt runtime dependencies...")

# Deploy main app
qt_deploy_runtime_dependencies(
    EXECUTABLE "${_MAIN_EXE}"
    PLUGINS "${QT_DEPLOY_PLUGINS}"
    EXCLUDE_PLUGINS "${QT_DEPLOY_EXCLUDE_PLUGINS}"
    EXCLUDE_MODULES "${QT_DEPLOY_EXCLUDE_MODULES}"
    EXCLUDE_LIBRARIES "${QT_DEPLOY_EXCLUDE_LIBRARIES}"
    PLUGINS_DIR .
    NO_TRANSLATIONS
)

message(STATUS "Main app Qt deployment completed")

# Deploy Updater if present
if(EXISTS "${_UPDATER_EXE}")
    message(STATUS "Deploying Updater Qt dependencies...")
    qt_deploy_runtime_dependencies(
        EXECUTABLE "${_UPDATER_EXE}"
        PLUGINS "${QT_DEPLOY_PLUGINS}"
        EXCLUDE_PLUGINS "${QT_DEPLOY_EXCLUDE_PLUGINS}"
        EXCLUDE_MODULES "${QT_DEPLOY_EXCLUDE_MODULES}"
        EXCLUDE_LIBRARIES "${QT_DEPLOY_EXCLUDE_LIBRARIES}"
        PLUGINS_DIR .
        NO_TRANSLATIONS
    )
    message(STATUS "Updater Qt deployment completed")
else()
    message(STATUS "Updater executable not found, skipping deployment")
endif()

message(STATUS "=== Qt Deploy Runtime Script Finished ===")